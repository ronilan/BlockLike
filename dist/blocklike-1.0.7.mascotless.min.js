var blockLike;(()=>{"use strict";var __webpack_modules__={75:(e,t,s)=>{function i(e,t){const s=new RegExp(`\\${t}`,"g");return(e.match(s)||[]).length}function n(e){return e.replace(/"(.*?)"|'(.*?)'|`(.*?)`/g," ")}function o(e,t){return e.some(e=>-1!==t.indexOf(`.${e}(`))}function h(e,t){let s=e.toString();const h=(a=s).substring(a.indexOf("(")+1,a.indexOf(")"));var a;if(function(e){const t=e.replace(/\s+/g,"").replace(/\r?\n|\r/g,"");return!!/while\([\s\S]*\){}|for\([\s\S]*\){}|do{}while\([\s\S]*\)/.exec(t)}(s))s="throw 'BlockLike.js Error: Empty loop detected';";else{s=function(e){return e.replace(/\/\*[\s\S]*?\*\/|([^\\:]|^)\/\/.*$/gm,"")}(function(e){return e.substring(e.indexOf("{")+1,e.lastIndexOf("}"))}(s)),s=s.split("\n").filter(e=>0!==e.trim().length);let e=0;s=s.map(s=>{const h=s;let a=h;return function(e,t){return o(t.evented,e)}(h,t)||e?e+=i(n(h),"(")-i(n(h),")"):(a===h&&(a=function(e,t){const s=`${e}\n await new Promise(resolve => setTimeout(resolve, ${t.pace}));`;return t.pace&&function(e,t){return o(t.paced,e)}(n(e),t)?s:e}(h,t)),a===h&&(a=function(e,t){let s,i=null;if(i=function(e,t){return o(t.waited,e)}(n(e),t),i)s=`${e.substring(0,e.lastIndexOf(")"))}, '${t.triggeringId}')`;else{let o=null;i=function(e,t){return t.waitedReturned.find(t=>-1!==e.indexOf(`.${t}(`)&&t)}(n(e),t),o=e.substr(0,e.indexOf("=")).replace("let","").replace("var","").replace("const","").trim(),s=`${e.substring(0,e.lastIndexOf(")"))}, '${o}', '${t.triggeringId}')`,"ask"===i&&(s=`await new Promise(resolve => setTimeout(resolve, 0));\n ${s}`),"invoke"===i&&-1===e.indexOf(",")&&(s=`${e.substring(0,e.lastIndexOf(")"))}, [], '${o}', '${t.triggeringId}')`)}return s=`${s}\n await new Promise(resolve => {\n      document.addEventListener('blockLike.waited.${t.triggeringId}', function waitedListener(e) {\n        document.removeEventListener('blockLike.waited.${t.triggeringId}', waitedListener);\n        resolve();\n      });\n    });`,i?s:e}(h,t)),a===h&&(a=function(e){const t=e.indexOf("async ");let s=/function(\s*?[a-zA-Z]\w*\s*?\(|\s*?\()/,i=s.exec(n(e));return i||(s=/([a-zA-Z]\w*|\(\s*?[a-zA-Z]\w*(,\s*[a-zA-Z]\w*)*\s*?\))\s*?=>/,i=s.exec(n(e))),-1===t&&i?`${e.substring(0,i.index)}async ${e.substring(i.index,e.length)}`:e}(h))),a=function(e){const t=e.replace(/\s+/g,"");return/while\([\S]*\){|for\([\S]*\){|do[\S]*{/.exec(t)?`${e}\n await new Promise(resolve => setTimeout(resolve, 0));`:e}(a),a}),s=s.join("\n")}const r=Object.getPrototypeOf(async()=>{}).constructor;let l=new r(s);return h&&(l=new r(h,s)),window.blockLike&&window.blockLike.debug&&console.log(l),l}s.d(t,{A:()=>h})},486:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{A:()=>Entity});var _rewriter__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(75),_element_css__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(787);class Entity{constructor(e){Entity.messageListeners=[],this.id=this._generateUUID(),this.pace=e,this.sounds=[],this.paced=["goTo","move","changeX","changeY","setX","setY","goTowards","turnRight","turnLeft","pointInDirection","pointTowards","changeSize","setSize","say","think","refresh"],this.waited=["wait","glide","sayWait","thinkWait","playSoundUntilDone","broadcastMessageWait"],this.waitedReturned=["invoke","ask"],this.evented=["whenFlag","whenLoaded","whenClicked","whenKeyPressed","whenEvent","whenReceiveMessage","whenCloned"]}_generateUUID(){let e,t;return e=(new Date).getTime(),window.performance&&"function"==typeof window.performance.now&&(e+=window.performance.now()),"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,s=>(t=(e+16*Math.random())%16|0,e=Math.floor(e/16),("x"===s?t:3&t|8).toString(16)))}_releaseWaited(e){const t=new window.CustomEvent(`blockLike.waited.${e}`,{detail:{value:0}});document.dispatchEvent(t)}_setToVar(varString,value){try{eval(`${varString} = '${value}'`)}catch(e){throw"BlockLike.js Error: Variables accepting a value must be declared in the global scope."}}_exec(e,t){const s=this;return s.triggeringId=this._generateUUID(),(0,_rewriter__WEBPACK_IMPORTED_MODULE_0__.A)(e,s).apply(s,t)}invoke(e,t,s=null,i=null){let n=t;!(t instanceof Array)&&(n=[t]),this._exec(e,n).then(e=>{this._releaseWaited(i),s&&this._setToVar(s,e)})}wait(e,t=null){setTimeout(()=>{this._releaseWaited(t)},1e3*e)}whenLoaded(e){setTimeout(()=>{this._exec(e,[])},0)}whenFlag(e){const t=this;t.element&&(t.element.addFlag(this),this.element.flag.addEventListener("click",s=>{t.element.removeFlag(t),t._exec(e,[s]),s.stopPropagation()}))}whenClicked(e){const t=this;t.element&&this.element.el.addEventListener("click",s=>{t._exec(e,[s]),s.stopPropagation()})}whenKeyPressed(e,t){const s=this;let i;i="string"==typeof e?e.toLowerCase():e,document.addEventListener("keydown",e=>{let n=!1;e.code&&e.code.toLowerCase()===i&&(n=!0),e.key&&e.key.toLowerCase()===i&&(n=!0),e.keyCode===i&&(n=!0),n&&s._exec(t,[e])})}whenEvent(e,t){const s=this;if(s.element){let i=this.element.el,n={};-1!=="keydown|keyup|keypress".indexOf(e)&&(i=document),-1!=="touchstart|touchmove".indexOf(e)&&(n={passive:!0}),i.addEventListener(e,e=>{s._exec(t,[e]),e.stopPropagation()},n)}}whenReceiveMessage(e,t){const s=this._generateUUID();Entity.messageListeners.push({msg:e,listenerId:s}),document.addEventListener(e,e=>{this._exec(t,[e]).then(()=>{const t=e.detail.msgId,i=new window.CustomEvent("blockLike.donewheneeceivemessage",{detail:{msgId:t,listenerId:s}});document.dispatchEvent(i)})})}broadcastMessage(e){const t=this._generateUUID(),s=new window.CustomEvent(e,{detail:{msgId:t}});document.dispatchEvent(s)}broadcastMessageWait(e,t=null){const s=this,i=this._generateUUID();let n=Entity.messageListeners.filter(t=>t.msg===e);const o=new window.CustomEvent(e,{detail:{msgId:i}});document.dispatchEvent(o),document.addEventListener("blockLike.donewheneeceivemessage",function e(o){o.detail.msgId===i&&(n=n.filter(e=>e.listenerId!==o.detail.listenerId)),n.length||(document.removeEventListener("blockLike.donewheneeceivemessage",e),s._releaseWaited(t))})}playSound(e){const t=new window.Audio(e);t.play(),this.sounds.push(t),t.addEventListener("ended",()=>{this.sounds=this.sounds.filter(e=>e!==t)})}playSoundLoop(e){const t=new window.Audio(e);t.play(),this.sounds.push(t),t.addEventListener("ended",()=>{t.currentTime=0,t.play()})}playSoundUntilDone(e,t=null){const s=new window.Audio(e);s.play(),this.sounds.push(s),s.addEventListener("ended",()=>{this.sounds=this.sounds.filter(e=>e!==s),this._releaseWaited(t)})}stopSounds(){this.sounds.forEach(e=>{e.pause()}),this.sounds=[]}css(e,t=null){_element_css__WEBPACK_IMPORTED_MODULE_1__.k(e,t,this),this.element&&this.element.update(this)}addClass(e){!this.hasClass(e)&&this.classes.push(e),this.element&&this.element.update(this)}removeClass(e){this.classes=this.classes.filter(t=>t!==e),this.element&&this.element.update(this)}hasClass(e){return-1!==this.classes.indexOf(e)}}},787:(e,t,s)=>{function i(e){const t=e,s=e.backdrop||e.costume,i=e.backdrops||e.costumes,n=e.element.el;i&&i.forEach(e=>{e.cssRules.forEach(e=>{const t=e.prop.replace(/-([a-z])/g,e=>e[1].toUpperCase());n.style[t]=""})}),s&&s.cssRules.forEach(e=>{const t=e.prop.replace(/-([a-z])/g,e=>e[1].toUpperCase());n.style[t]=e.value}),t.cssRules.forEach(e=>{const t=e.prop.replace(/-([a-z])/g,e=>e[1].toUpperCase());n.style[t]=e.value})}function n(e,t,s){const i=s;if("string"==typeof e&&"string"==typeof t){const s=e.replace(/([A-Z])/g,e=>`-${e.toLowerCase()}`);i.cssRules.push({prop:s,value:t})}else"object"!=typeof e||t||Object.keys(e).forEach(t=>{const s=t.replace(/([A-Z])/g,e=>`-${e.toLowerCase()}`);i.cssRules.push({prop:s,value:e[t]})})}s.d(t,{B:()=>i,k:()=>n})}},__webpack_module_cache__={};function __webpack_require__(e){var t=__webpack_module_cache__[e];if(void 0!==t)return t.exports;var s=__webpack_module_cache__[e]={exports:{}};return __webpack_modules__[e](s,s.exports,__webpack_require__),s.exports}__webpack_require__.d=(e,t)=>{for(var s in t)__webpack_require__.o(t,s)&&!__webpack_require__.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:t[s]})},__webpack_require__.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),__webpack_require__.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var __webpack_exports__={};__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{Backdrop:()=>Backdrop,Costume:()=>Costume,Sprite:()=>Sprite,Stage:()=>Stage});const defaultCSS="\n* { \n  box-sizing: border-box;\n  -webkit-transform: translate3d(0, 0, 0);\n  -webkit-touch-callout:none;                /* prevent callout to copy image, etc when tap to hold */\n  -webkit-tap-highlight-color:rgba(0,0,0,0); /* prevent tap highlight color / shadow */\n}\nhtml, body{\n  margin:0;\n  padding:0;\n}\n",uiCSS="\n.blocklike-flag {\n  text-align: center;\n  font-family: Arial, Helvetica, sans-serif;\n  font-size: 65px;\n  line-height: 65px;\n  padding: 32px;\n  color: #222;\n  background: #fafafa;\n  border: 2px solid #666;\n  border-radius: 65px;\n}\n",thinkCSS='\n.blocklike-think {\n  position: absolute;\n  min-width: 60px;\n  max-width: 200px;\n  left: 200px;\n  padding: 10px;\n  font-family: Arial, Helvetica, sans-serif;\n  font-size: 16px;\n  min-height: 16px;\n  line-height: 16px;\n  text-align: left;\n  color: #222;\n  background: #fafafa;\n  border: 2px solid #444;\n  border-radius: 20px;\n}\n.blocklike-think:before {\n  position:absolute;\n  bottom: -30px;\n  left: 0px;\n  width: 30px;\n  height: 30px;\n  background: #fafafa;\n  border: 2px solid #444;\n  border-radius: 20px;\n  content: "";\n}\n.blocklike-think:after {\n  position: absolute;\n  bottom: -45px;\n  left: 0px;\n  width: 15px;\n  height: 15px;\n  background: #fafafa;\n  border: 2px solid #444;\n  border-radius: 15px;\n  content: "";\n}\n',sayCSS="\n.blocklike-ask,\n.blocklike-say {\n  position: absolute;\n  display: inline-block;\n  min-width: 60px;\n  max-width: 200px;\n  padding: 10px;\n  font-family: Arial, Helvetica, sans-serif;\n  font-size: 16px;\n  min-height: 16px;\n  line-height: 16px;\n  text-align: left;\n  background-color: #fafafa;\n  border: 2px solid #444;\n  border-radius: 20px;\n}\n.blocklike-ask:before,\n.blocklike-say:before {\n  content: ' ';\n  position: absolute;\n  width: 0;\n  height: 0;\n  left: 13px;\n  right: auto;\n  top: auto;\n  bottom: -33px;\n  border: 16px solid;\n  border-color: #444 transparent transparent #444;\n}\n.blocklike-ask:after,\n.blocklike-say:after {\n  content: ' ';\n  position: absolute;\n  width: 0;\n  height: 0;\n  left: 15px;\n  right: auto;\n  top: auto;\n  bottom: -28px;\n  border: 16px solid;\n  border-color: #fafafa transparent transparent #fafafa;\n}\n",askCSS="\n.blocklike-ask input {\n  font-family: Arial, Helvetica, sans-serif;\n  font-size: 16px;\n  padding: 2px;\n  margin: 2px;\n  width: 75%;\n}\n.blocklike-ask button {\n  font-size: 16px;\n  line-height: 16px;\n  height: 26px;\n  padding: 0 5px;\n  margin: 0;\n}\n";function platforms(){window.CP&&(window.CP.PenTimer.MAX_TIME_IN_LOOP_WO_EXIT=6e4)}var entity=__webpack_require__(486),element_css=__webpack_require__(787);class StageElement{constructor(e,t){const s=document.createElement("div");function i(t){const s=document.createElement("canvas");return s.width=e.width,s.height=e.height,s.style.zIndex=t,s.style.position="absolute",s.style.left="0px",s.style.top="0px",s}s.id=`${t.id}`,s.style.width=`${e.width}px`,s.style.height=`${e.height}px`,s.style.position="relative",s.style.boxSizing="border-box",s.style.overflow="hidden",e.parent.appendChild(s),this.backdropContainer=i(0),this.backdropContainer.id=`${t.id}-backdrop`,this.backdropContainer.className="blocklike-panel-backdrop",s.appendChild(this.backdropContainer),this.canvas=i(0),this.canvas.id=`${t.id}-surface`,this.canvas.className="blocklike-panel-surface",s.appendChild(this.canvas),this.flag=function(){const t=function(){const t=document.createElement("div");return t.style.width=`${e.width}px`,t.style.height=`${e.height}px`,t.style.zIndex=-1,t.style.position="absolute",t.style.touchAction="manipulation",t}(),s=document.createElement("div");return s.style.width="130px",s.style.height="130px",s.style.position="absolute",s.innerHTML="&#9873;",s.style.left=e.width/2-65+"px",s.style.top=e.height/2-65+"px",s.className="blocklike-flag",t.appendChild(s),t.style.display="none",t}(),this.flag.id=`${t.id}-flag`,this.flag.className="blocklike-panel-flag",s.appendChild(this.flag),this.context=this.canvas.getContext("2d"),this.el=s}update(e){const t=e.element.el,s=e.element.backdropContainer.getContext("2d");let i=0;if("BODY"===e.element.el.parentElement.tagName&&(i=Math.floor((window.innerHeight-e.height)/2),i<0&&(i=0)),e.backdrop&&e.backdrop.color?(s.rect(0,0,e.width,e.height),s.fillStyle=e.backdrop.color,s.fill()):s.clearRect(0,0,e.width,e.height),e.backdrop&&e.backdrop.image){const t=new Image;t.onload=()=>{s.drawImage(t,0,0,e.width,e.height)},t.src=e.backdrop.image}t.style.transform=`scale(${e.magnification/100})`,t.style.margin=`${i}px auto`,element_css.B(e),e.backdrop?t.className=e.backdrop.classes.concat(e.classes).join(" "):t.className=e.classes.join(" ")}delete(e){const t=e.element.el;return t.parentNode.removeChild(t),null}addFlag(e){const t=e.element.flag;t.style.zIndex=1e3,t.style.display="block"}removeFlag(e){const t=e.element.flag;t.style.zIndex=-1,t.style.display="none"}}class StageSurface{constructor(e){this.context=e.element.context}draw(e){e.drawing&&(this.context.beginPath(),this.context.moveTo(e.stageWidth/2+e.x,e.stageHeight/2+-1*e.y),this.context.lineTo(e.stageWidth/2+e.prevX,e.stageHeight/2+-1*e.prevY),this.context.lineWidth=e.penSize,this.context.strokeStyle=e.penColor,this.context.stroke())}clear(e){this.context.clearRect(0,0,e.stageWidth,e.stageHeight)}}class SpriteElement{constructor(e,t){const s=document.createElement("div");s.id=`${e.id}`,s.style.position="absolute",s.style.touchAction="manipulation",t.element.el.appendChild(s),this.el=s}update(e){const t=e.element.el,s=e.x-e.width/2,i=-1*e.y-e.height/2;if(e.costume&&(t.style.width=`${e.costume.visibleWidth}px`,t.style.height=`${e.costume.visibleHeight}px`),t.style.left=`${e.stageWidth/2+s}px`,t.style.top=`${e.stageHeight/2+i}px`,t.style.zIndex=e.z,t.style.visibility=e.showing?"visible":"hidden",1===e.rotationStyle&&(t.style.transform=`scaleX(${-1*(2*Math.floor(e.direction/180)-1)})`),0===e.rotationStyle&&(t.style.transform=`rotate(${(e.direction-90+360)%360}deg)`),(!e.costume||!e.costume.color)&&(t.style.backgroundColor=""),element_css.B(e),e.costume?t.className=e.costume.classes.concat(e.classes).join(" "):t.className=e.classes.join(" "),e.costume&&e.costume.color&&(t.style.backgroundColor=e.costume.color),e.costume&&t.firstChild)e.costume.image?e.costume.image!==this.el.firstChild.src&&(this.el.firstChild.src=e.costume.image):t.removeChild(t.firstChild);else if(e.costume&&e.costume.image){const s=new window.Image;s.style.width="100%",s.style.height="100%",s.style.position="absolute",s.src=e.costume.image,t.appendChild(s)}t.firstChild&&(t.firstChild.draggable=!1),e.costume&&e.costume.innerHTML&&(t.innerHTML=e.costume.innerHTML),e.textui&&e.textui.update(e),this.el=t}delete(e){const t=e.element.el;return t.parentNode.removeChild(t),null}addFlag(e){const t=e.element.flag;t.style.zIndex=1e3,t.style.display="block"}removeFlag(e){const t=e.element.flag;t.style.zIndex=-1,t.style.display="none"}}function enable(e){const t=e;function s(e,t){return Math.round(e*10**t)/10**t}function i(e){const i=t.magnification/100;return s((e-t.element.el.offsetLeft-t.width/2)/i,2)}function n(e){const i=t.magnification/100;return s((-e+t.element.el.offsetTop+t.height/2)/i,2)}t.sensing=!0,document.addEventListener("keydown",e=>{e.key&&-1===t.keysKey.indexOf(e.key.toLowerCase())&&t.keysKey.push(e.key.toLowerCase()),e.code&&-1===t.keysCode.indexOf(e.code.toLowerCase())&&t.keysCode.push(e.code.toLowerCase()),-1===t.keysKeyCode.indexOf(e.keyCode)&&t.keysKeyCode.push(e.keyCode)}),document.addEventListener("keyup",e=>{e.key&&(t.keysKey=t.keysKey.filter(t=>t!==e.key.toLowerCase())),e.code&&(t.keysCode=t.keysCode.filter(t=>t!==e.code.toLowerCase())),t.keysKeyCode=t.keysKeyCode.filter(t=>t!==e.keyCode)}),t.element.el.addEventListener("mousemove",e=>{t.mouseX=i(e.clientX),t.mouseY=n(e.clientY)}),t.element.el.addEventListener("touchmove",e=>{t.mouseX=i(e.changedTouches[0].clientX),t.mouseY=n(e.changedTouches[0].clientY)},{passive:!0}),t.element.el.addEventListener("mousedown",()=>{t.mouseDown=!0}),t.element.el.addEventListener("mouseup",()=>{t.mouseDown=!1}),t.element.el.addEventListener("touchstart",e=>{t.mouseX=i(e.touches[0].clientX),t.mouseY=n(e.touches[0].clientY),t.mouseDown=!0},{passive:!0}),t.element.el.addEventListener("touchend",()=>{t.mouseDown=!1,t.mouseX=null,t.mouseY=null})}class Stage extends entity.A{constructor(e={}){const t={width:window.innerWidth,height:window.innerHeight,parent:document.body,pace:33,backdrop:null,...e};super(t.pace),this.backdrops=[],t.backdrop&&(this.backdrop=t.backdrop,this.backdrops.push(this.backdrop)),this.element=new StageElement(t,this),this.width=t.width,this.height=t.height,this.keysCode=[],this.keysKey=[],this.keysKeyCode=[],this.sprites=[],this.magnification=100,this.cssRules=[],this.classes=[],this.mouseDown=null,this.mouseX=null,this.mouseY=null,t.sensing&&enable(this),this.element.update(this)}delete(){this.element=this.element.delete(this)}addSprite(e){const t=e;t.element=new SpriteElement(e,this),t.surface=new StageSurface(this),t.element.flag=this.element.flag,t.againstBackdrop=this.element.backdropContainer,t.stageWidth=this.width,t.stageHeight=this.height,this.sprites.push(t),t.z=this.sprites.length,e.element.update(t)}removeSprite(e){const t=e;this.sprites=this.sprites.filter(t=>t!==e),t.element&&(t.element=t.element.delete(t))}addBackdrop(e){this.backdrops.push(e),!this.backdrop&&(this.backdrop=this.backdrops[0]),this.element&&this.element.update(this)}switchBackdropTo(e){const t=this.backdrops.indexOf(e);-1!==t&&(this.backdrop=this.backdrops[t]),this.element&&this.element.update(this)}switchBackdropToNum(e){this.switchBackdropTo(this.backdrops[e])}nextBackdrop(){const e=this.backdrops.indexOf(this.backdrop);this.backdrop=this.backdrops[(e+1)%this.backdrops.length],this.element&&this.element.update(this)}removeBackdrop(e){if(this.backdrops.length>1){const t=this.backdrops.indexOf(e);this.backdrop===e&&(this.backdrop=this.backdrops[(t+1)%this.backdrops.length]),this.backdrops=this.backdrops.filter(t=>t!==e)}else this.backdrops=[],this.backdrop=null;this.element&&this.element.update(this)}removeBackdropNum(e){this.removeBackdrop(this.backdrops[e])}refresh(){this.element&&this.element.update(this)}zoom(e){this.magnification=e,this.element.update(this)}_refreshSprites(){let e=0;this.sprites.forEach(t=>{const s=t;e+=1,s.z=e,s.element&&s.element.update(s)})}sendSpriteBackwards(e){const t=this.sprites.indexOf(e);t>0&&(this.sprites[t]=this.sprites[t-1],this.sprites[t-1]=e),this._refreshSprites()}sendSpriteForward(e){const t=this.sprites.indexOf(e);t<this.sprites.length-1&&-1!==t&&(this.sprites[t]=this.sprites[t+1],this.sprites[t+1]=e),this._refreshSprites()}sendSpriteToFront(e){const t=this.sprites.indexOf(e);-1!==t&&(this.sprites.splice(t,1),this.sprites.push(e)),this._refreshSprites()}sendSpriteToBack(e){const t=this.sprites.indexOf(e);-1!==t&&(this.sprites.splice(t,1),this.sprites.unshift(e)),this._refreshSprites()}isKeyPressed(e){let t,s=!1;return t="string"==typeof e?e.toLowerCase():e,-1!==this.keysKey.indexOf(t)&&(s=!0),-1!==this.keysCode.indexOf(t)&&(s=!0),-1!==this.keysKeyCode.indexOf(t)&&(s=!0),!this.sensing&&console.log("BlockLike.js Notice: isKeyPressed() ingnored. Stage sensing not enabled."),s}}class Look{constructor(){this.cssRules=[],this.classes=[]}css(e,t=null){element_css.k(e,t,this)}addClass(e){!this.hasClass(e)&&this.classes.push(e)}removeClass(e){this.classes=this.classes.filter(t=>t!==e)}hasClass(e){return-1!==this.classes.indexOf(e)}}class Backdrop extends Look{constructor(e={}){const t={...e};super(),this.image=t.image,this.color=t.color,this.image&&((new window.Image).src=this.image)}addTo(e){const t=e;e.backdrops.push(this),!e.backdrop&&(t.backdrop=e.backdrops[0]),e.element&&e.element.update(e)}removeFrom(e){e.removeBackdrop(this)}}class Costume extends Look{constructor(e={}){const t={width:100,height:100,color:null,...e};super(),this.width=t.width,this.height=t.height,this.visibleWidth=t.width,this.visibleHeight=t.height,this.image=t.image,this.color=t.color,this.image&&((new window.Image).src=this.image),this.innerHTML=""}addTo(e){const t=e;e.costumes.push(this),e.costume||(t.costume=e.costumes[0],t.width=e.costume.visibleWidth,t.height=e.costume.visibleHeight),e.element&&e.element.update(e)}removeFrom(e){e.removeCostume(this)}resizeToImage(){if(this.image){const e=new window.Image,t=this;e.src=this.image,e.addEventListener("load",()=>{t.width=e.width,t.height=e.height,t.visibleWidth=t.width,t.visibleHeight=t.height})}}inner(e){this.innerHTML=e}insert(e){const t=e.cloneNode(!0);t.style.display="block",t.style.visibility="inherit",this.image=null,this.color="transparent",this.innerHTML=t.outerHTML}}class TextUiElement{constructor(e,t,s){const i=document.createElement("div");this.text=s.toString(),this.type=t;const n=e.x-e.width/2,o=-1*e.y-e.height/2;i.style.position="absolute",i.innerHTML=`${s}<br />`,i.style.left=`${e.stageWidth/2+n+.6*e.width}px`,i.style.top=e.stageHeight/2+o-80-16*Math.floor(this.text.length/30)+"px",i.style.zIndex=e.z,i.className=`blocklike-${t}`;let h=null;"ask"===t&&(h=function(){function t(t){const s=new window.CustomEvent(`blockLike.ask.${e.id}.${e.askId}`,{detail:{value:t,askId:e.askId}});document.dispatchEvent(s)}const s=document.createElement("input");s.addEventListener("keydown",e=>{13===e.keyCode&&(t(s.value),s.value="")}),i.appendChild(s);const n=document.createElement("button");return n.innerHTML="&#x2713",n.addEventListener("click",()=>{t(s.value),s.value=""}),i.appendChild(n),s}(),i.style.top=e.stageHeight/2+o-110-16*Math.floor(this.text.length/30)+"px"),e.element.el.parentNode.insertBefore(i,e.element.el),h&&h.focus(),i.style.visibility=e.showing?"visible":"hidden",this.el=i}update(e){const t=e.textui.el,s=e.x-e.width/2,i=-1*e.y-e.height/2;t.style.left=`${e.stageWidth/2+s+.6*e.width}px`,t.style.top=e.stageHeight/2+i-80-16*Math.floor(this.text.length/30)+"px","ask"===e.textui.type&&(t.style.top=e.stageHeight/2+i-110-16*Math.floor(this.text.length/30)+"px"),t.style.visibility=e.showing?"visible":"hidden"}delete(e){const t=e.textui.el;return t.parentNode.removeChild(t),null}}class Sprite extends entity.A{constructor(e={}){const t={pace:33};let s={};if(s="object"==typeof e?{...t,...e}:t,super(s.pace),this.costumes=[],"string"==typeof e){s.costume=new Costume({image:e,width:0,height:0});const t=new window.Image,i=s.costume;t.src=e,t.addEventListener("load",()=>{i.originalWidth=t.width,i.originalHeight=t.height,i.width=i.originalWidth,i.height=i.originalHeight,this.refresh()})}if(void 0===s.costume&&null!==e){const e={};s.width&&(e.width=s.width),s.height&&(e.height=s.height),s.color&&(e.color=s.color),void 0!==s.image?e.image=s.image:e.image="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVQYV2NgYAAAAAMAAWgmWQ0AAAAASUVORK5CYII=",s.costume=new Costume(e)}s.costume&&(this.costume=s.costume),this.costume&&this.costumes.push(this.costume),this.costume?this.width=this.costume.visibleWidth:this.width=0,this.costume?this.height=this.costume.visibleHeight:this.height=0,this.x=0,this.y=0,this.z=0,this.prevX=0,this.prevY=0,this.showing=!0,this.direction=90,this.magnification=100,this.rotationStyle=0,this.textui=null,this.drawing=!1,this.penColor="#222222",this.penSize=1,this.cssRules=[],this.classes=[]}addTo(e){this.stageWidth=e.width,this.stageHeight=e.height,this.element=new SpriteElement(this,e),this.surface=new StageSurface(e),this.element.flag=e.element.flag,this.againstBackdrop=e.element.backdropContainer,e.sprites.push(this),this.z=e.sprites.length,this.element.update(this)}clone(){const e=new Sprite,t=e.id,s=Object.assign(e,this);s.id=t,s.element=null,s.surface=null,s.cssRules=JSON.parse(JSON.stringify(this.cssRules)),s.classes=this.classes.slice();const i=this.costumes.indexOf(this.costume);s.costumes=this.costumes.map(e=>{const t=new Costume,s=Object.assign(t,e);return s.cssRules=JSON.parse(JSON.stringify(e.cssRules)),s.classes=e.classes.slice(),s}),s.costume=s.costumes[i];const n=new window.CustomEvent(`blockLike.spritecloned.${this.id}`,{detail:s});return document.dispatchEvent(n),s}removeFrom(e){e.sprites=e.sprites.filter(e=>e!==this),this.element&&(this.element=this.element.delete(this))}whenCloned(e){document.addEventListener(`blockLike.spritecloned.${this.id}`,t=>{t.detail._exec(e,[]),t.stopPropagation()})}_motion(e,t){this.prevX=this.x,this.prevY=this.y,this.x=e,this.y=t,this.element&&this.element.update(this),this.surface&&this.surface.draw(this)}glide(e,t,s,i=null){let n=0;const o=this,h=1e3/this.pace,a=(t-this.x)/(e*h),r=(s-this.y)/(e*h),l=setInterval(()=>{n+=1,o._motion(o.x+a,o.y+r),n/h>=e&&(clearInterval(l),o._motion(t,s),o._releaseWaited(i))},this.pace)}move(e){function t(e){return e*(Math.PI/180)}const s=Math.round(Math.cos(t(this.direction-90))*e),i=Math.round(Math.sin(t(this.direction+90))*e);this._motion(this.x+s,this.y+i)}goTo(e,t){this._motion(e,t)}goTowards(e){this._motion(e.x,e.y)}setX(e){this._motion(e,this.y)}setY(e){this._motion(this.x,e)}changeX(e){this._motion(this.x+e,this.y)}changeY(e){this._motion(this.x,this.y+e)}pointInDirection(e){this.direction=e>0?e%360:(e+3600)%360,this.element&&this.element.update(this)}pointTowards(e){this.direction=function(e,t,s,i){let n=(Math.atan((e-s)/(t-i))*(180/Math.PI)+90*(Math.sign(t-i)+1)+360)%360;return t-i===0&&(n+=90),n}(this.x,this.y,e.x,e.y),this.element&&this.element.update(this)}turnRight(e){this.direction=(this.direction+e)%360,this.element&&this.element.update(this)}turnLeft(e){this.direction=(this.direction+360-e)%360,this.element&&this.element.update(this)}setRotationStyle(e){let t=e;"no"===e&&(t=2),"left-right"===e&&(t=1),"all"===e&&(t=0),this.rotationStyle=t}_refreshCostume(){this.costume&&(this.width=this.costume.visibleWidth,this.height=this.costume.visibleHeight),this.element&&this.element.update(this)}addCostume(e){this.costumes.push(e),this.costume||(this.costume=this.costumes[0],this.width=this.costume.visibleWidth,this.height=this.costume.visibleHeight),this.element&&this.element.update(this)}switchCostumeTo(e){const t=this.costumes.indexOf(e);-1!==t&&(this.costume=this.costumes[t]),this._refreshCostume()}switchCostumeToNum(e){this.switchCostumeTo(this.costumes[e])}nextCostume(){const e=this.costumes.indexOf(this.costume);this.costume=this.costumes[(e+1)%this.costumes.length],this._refreshCostume()}removeCostume(e){if(this.costumes.length>1){const t=this.costumes.indexOf(e);this.costume===e&&(this.costume=this.costumes[(t+1)%this.costumes.length]),this.costumes=this.costumes.filter(t=>t!==e)}else this.costumes=[],this.costume=null;this._refreshCostume()}removeCostumeNum(e){this.removeCostume(this.costumes[e])}show(){this.showing=!0,this.element&&this.element.update(this)}hide(){this.showing=!1,this.element&&this.element.update(this)}refresh(){const e=this;setTimeout(()=>{e.setSize(e.magnification),e.element&&e.element.update(e)},this.pace)}resizeToImage(){this.costume&&this.costume.resizeToImage(),this.refresh()}inner(e){this.costume.inner(e),this.element&&this.element.update(this)}insert(e){this.costume.insert(e),this.element&&this.element.update(this)}_refreshSize(){function e(e,t){return Math.round(e*10**t)/10**t}this.costume&&(this.width=e(this.costume.width*(this.magnification/100),2),this.height=e(this.costume.height*(this.magnification/100),2),this.costumes.forEach(t=>{const s=t;s.visibleWidth=e(s.width*(this.magnification/100),2),s.visibleHeight=e(s.height*(this.magnification/100),2)}),this.costume.visibleWidth=this.width,this.costume.visibleHeight=this.height,this.element&&this.element.update(this))}changeSize(e){this.magnification+=e,this._refreshSize()}setSize(e){this.magnification=e,this._refreshSize()}think(e){this.element&&(this.textui&&(this.textui=this.textui.delete(this)),void 0!==e&&e.toString()&&(this.textui=new TextUiElement(this,"think",e)))}thinkWait(e,t,s=null){setTimeout(()=>{this.think(""),this._releaseWaited(s)},1e3*t),this.think(e)}say(e){this.element&&(this.textui&&(this.textui=this.textui.delete(this)),void 0!==e&&e.toString()&&(this.textui=new TextUiElement(this,"say",e)))}sayWait(e,t,s=null){setTimeout(()=>{this.say(""),this._releaseWaited(s)},1e3*t),this.say(e)}ask(e,t=null,s=null){const i=this;i.askId=this._generateUUID(),this.element&&(this.textui&&(this.textui=this.textui.delete(this)),void 0!==e&&e.toString()&&(this.textui=new TextUiElement(i,"ask",e)),document.addEventListener(`blockLike.ask.${this.id}.${i.askId}`,function e(n){document.removeEventListener(`blockLike.ask.${i.id}.${i.askId}`,e),i._releaseWaited(s),t&&i._setToVar(t,n.detail.value),i.textui&&(i.textui=i.textui.delete(i))}))}penClear(){this.surface.clear(this)}penDown(){this.drawing=!0,this.prevX=this.x,this.prevY=this.y,this.surface.draw(this)}penUp(){this.drawing=!1,this.surface.draw(this)}setPenColor(e){this.penColor=e}setPenSize(e){this.penSize=e}changePenSize(e){this.penSize+=e}distanceTo(e,t){const s=this.x-e,i=this.y-t;return Math.sqrt(s*s+i*i)}touchingEdge(){let e=null;return this.x+this.width/2>this.stageWidth/2&&(e="right"),this.x-this.width/2<this.stageWidth/2*-1&&(e="left"),this.y+this.height/2>this.stageHeight/2&&(e="top"),this.y-this.height/2<this.stageHeight/2*-1&&(e="bottom"),e}isTouchingEdge(){return!!this.touchingEdge()}touching(e){let t=null;return this.x+this.width/2>e.x-e.width/2&&this.x-this.width/2<e.x+e.width/2&&this.y+this.height/2>e.y-e.height/2&&this.y-this.height/2<e.y+e.height/2&&(this.x>=e.x&&(t="left"),this.x<e.x&&(t="right"),this.y>e.y&&Math.abs(this.y-e.y)>Math.abs(this.x-e.x)&&(t="bottom"),this.y<e.y&&Math.abs(this.y-e.y)>Math.abs(this.x-e.x)&&(t="top")),t}isTouching(e){return!!this.touching(e)}touchingBackdropColor(){const e=[];function t(e,t,s){return`#${((1<<24)+(e<<16)+(t<<8)+s).toString(16).slice(1)}`}try{const s=this.againstBackdrop.getContext("2d").getImageData(this.stageWidth/2-this.width/2+this.x,this.stageHeight/2-this.height/2-this.y,this.width,this.height).data;for(let i=0;i<s.length;i+=4)0!==s[i+3]&&e.push(t(s[i],s[i+1],s[i+2]))}catch(e){console.log("BlockLike.js Notice: isTouchingBackdropColor() ingnored. Backdrop image can not be located at a remote origin.")}return Array.from(new Set(e))}isTouchingBackdropColor(e){return this.touchingBackdropColor(e).includes(e)}}!function(){const e=document.createElement("style");e.type="text/css",e.innerHTML=`\n    ${defaultCSS}\n\n \n    ${uiCSS}\n\n \n    ${thinkCSS}\n\n \n    ${sayCSS} \n\n \n    ${askCSS}`,document.getElementsByTagName("head")[0].appendChild(e),platforms()}(),blockLike=__webpack_exports__})();